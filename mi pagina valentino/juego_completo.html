<!DOCTYPE html>
<html>
<head>
<title>Juego Completo</title>
</head>

<body style="font-family:Arial; text-align:center; background:#dff1ff;">

<h1>ğŸ® Mi Juego</h1>

<!-- ===== MISIONES ===== -->
<h2>ğŸ¯ MisiÃ³n Diaria</h2>
<p id="misionTexto">Cargando misiÃ³n...</p>
<button onclick="hacerMision()">Completar misiÃ³n</button>

<hr>

<!-- ===== MONEDAS ===== -->
<h2>ğŸ’° Monedas</h2>
<p id="monedasTexto"></p>
<button onclick="ganarMonedas()">Ganar +10 monedas</button>

<hr>

<!-- ===== TIENDA ===== -->
<h2>ğŸ›’ Tienda</h2>
<button onclick="comprarVIP()">VIP (50 monedas)</button>
<button onclick="comprarADMIN()">ADMIN (100 monedas)</button>
<p id="estado"></p>

<hr>

<!-- ===== CHAT ===== -->
<h2>ğŸ’¬ Chat</h2>

<div id="chat" style="
border:2px solid black;
width:320px;
height:200px;
overflow:auto;
background:white;
padding:5px;
margin:auto;
text-align:left;
"></div>

<br>

<input id="mensajeInput" placeholder="EscribÃ­ un mensaje">
<button onclick="enviar()">Enviar</button>

<script>
/* ===== DATOS ===== */
let miNombre = "Valen";
let monedas = Number(localStorage.getItem("monedas")) || 0;
let miRango = localStorage.getItem("rango") || "NORMAL";

/* ===== MOSTRAR ===== */
function mostrarMonedas() {
    document.getElementById("monedasTexto").innerHTML =
        "Monedas: " + monedas;
}

function mostrarRango() {
    document.getElementById("estado").innerHTML =
        "Rango: " + miRango;
}

mostrarMonedas();
mostrarRango();

/* ===== MONEDAS ===== */
function ganarMonedas() {
    monedas += 10;
    localStorage.setItem("monedas", monedas);
    mostrarMonedas();
}

/* ===== TIENDA ===== */
function comprarVIP() {
    if (monedas >= 50) {
        monedas -= 50;
        miRango = "VIP";
        guardar();
        alert("ğŸ‰ Compraste VIP");
    } else {
        alert("âŒ No tenÃ©s monedas");
    }
}

function comprarADMIN() {
    if (monedas >= 100) {
        monedas -= 100;
        miRango = "ADMIN";
        guardar();
        alert("ğŸ‘‘ Compraste ADMIN");
    } else {
        alert("âŒ No tenÃ©s monedas");
    }
}

function guardar() {
    localStorage.setItem("monedas", monedas);
    localStorage.setItem("rango", miRango);
    mostrarMonedas();
    mostrarRango();
}

/* ===== MISION ===== */
let hoy = new Date().toDateString();
let ultimoDia = localStorage.getItem("ultimoDiaMision");
let mensajesHoy = 0;

function mostrarMision() {
    if (ultimoDia === hoy) {
        document.getElementById("misionTexto").innerHTML =
            "âœ… MisiÃ³n completada. VolvÃ© maÃ±ana";
    } else {
        document.getElementById("misionTexto").innerHTML =
            "ğŸ’¬ MandÃ¡ 3 mensajes (+30 monedas)";
    }
}

mostrarMision();

function hacerMision() {
    if (ultimoDia === hoy) {
        alert("âŒ Ya hiciste la misiÃ³n hoy");
        return;
    }

    if (mensajesHoy >= 3) {
        monedas += 30;
        localStorage.setItem("monedas", monedas);
        localStorage.setItem("ultimoDiaMision", hoy);
        ultimoDia = hoy;
        mostrarMonedas();
        mostrarMision();
        alert("ğŸ‰ MisiÃ³n completada +30 monedas");
    } else {
        alert("âš ï¸ MandÃ¡ 3 mensajes primero");
    }
}

/* ===== CHAT ===== */
function enviar() {
    let chat = document.getElementById("chat");
    let input = document.getElementById("mensajeInput");
    let texto = input.value;
    if (texto === "") return;

    mensajesHoy++;

    let color = "black";
    let tag = "";
    let borrar = "";

    if (miRango === "VIP") {
        color = "gold";
        tag = "[VIP] ";
    }

    if (miRango === "ADMIN") {
        color = "red";
        tag = "[ADMIN] ";
        borrar = "<button onclick='this.parentElement.remove()'>âŒ</button>";
    }

    chat.innerHTML += `
    <div>
        <b style="color:${color}">${tag}${miNombre}:</b>
        ${texto} ${borrar}
    </div>
    `;

    input.value = "";
    chat.scrollTop = chat.scrollHeight;
}
</script>

</body>
</html>
